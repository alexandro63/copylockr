{"version":3,"file":"copylockr.min.js","sources":["../src/copylockr.js"],"sourcesContent":["(function (root, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    define([], factory);\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    module.exports = factory();\r\n  } else {\r\n    root.CopyLockr = factory();\r\n  }\r\n}(typeof self !== 'undefined' ? self : this, function () {\r\n  'use strict';\r\n\r\n  var CopyLockr = {\r\n    enabled: false,\r\n    version: '2.0.0',\r\n    settings: {\r\n      disableContextMenu: true,\r\n      disableCopy: true,\r\n      disableCut: true,\r\n      disableDrag: true,\r\n      disableSelect: true,\r\n      disableDevTools: true,\r\n      password: null,\r\n      customStyles: true,\r\n      debug: false,\r\n      onBlock: null\r\n    },\r\n    \r\n    _styleElement: null,\r\n    _observer: null,\r\n    \r\n    _handleEvent: function(e) {\r\n      if (this.settings.onBlock) {\r\n        this.settings.onBlock(e.type, e);\r\n      }\r\n      \r\n      if (this.settings.debug) {\r\n        console.log('Blocked event:', e.type);\r\n      }\r\n      \r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return false;\r\n    },\r\n\r\n    _handleKeydown: function(e) {\r\n      var ctrlOrMeta = e.ctrlKey || e.metaKey;\r\n      var blockedCombinations = [\r\n        ctrlOrMeta && e.keyCode === 85,  // Ctrl+U\r\n        e.keyCode === 123,               // F12\r\n        ctrlOrMeta && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67) // DevTools\r\n      ];\r\n\r\n      if (blockedCombinations.some(Boolean)) {\r\n        this._handleEvent(e);\r\n      }\r\n    },\r\n\r\n    _applyStyles: function() {\r\n      if (this.settings.disableSelect && this.settings.customStyles) {\r\n        this._styleElement = document.createElement('style');\r\n        this._styleElement.textContent = `\r\n          body * {\r\n            -webkit-user-select: none !important;\r\n            -moz-user-select: none !important;\r\n            -ms-user-select: none !important;\r\n            user-select: none !important;\r\n          }\r\n          img, [data-copylockr-allow] {\r\n            -webkit-user-drag: none !important;\r\n            -moz-user-drag: none !important;\r\n            -ms-user-drag: none !important;\r\n            user-drag: none !important;\r\n          }\r\n        `;\r\n        document.head.appendChild(this._styleElement);\r\n      }\r\n    },\r\n\r\n    _observeDOM: function() {\r\n      if (this.settings.disableSelect) {\r\n        this._observer = new MutationObserver(function(mutations) {\r\n          mutations.forEach(function(mutation) {\r\n            Array.from(mutation.addedNodes).forEach(function(node) {\r\n              if (node.nodeType === 1) { // Element node\r\n                node.style.userSelect = 'none';\r\n              }\r\n            });\r\n          });\r\n        });\r\n\r\n        this._observer.observe(document.body, {\r\n          childList: true,\r\n          subtree: true\r\n        });\r\n      }\r\n    },\r\n\r\n    _attachListeners: function() {\r\n      var events = {\r\n        contextmenu: this.settings.disableContextMenu,\r\n        copy: this.settings.disableCopy,\r\n        cut: this.settings.disableCut,\r\n        dragstart: this.settings.disableDrag\r\n      };\r\n\r\n      Object.entries(events).forEach(([event, enabled]) => {\r\n        if (enabled) document.addEventListener(event, this._handleEvent.bind(this), true);\r\n      });\r\n\r\n      if (this.settings.disableDevTools) {\r\n        document.addEventListener('keydown', this._handleKeydown.bind(this), true);\r\n      }\r\n    },\r\n\r\n    _detachListeners: function() {\r\n      document.removeEventListener('contextmenu', this._handleEvent, true);\r\n      document.removeEventListener('copy', this._handleEvent, true);\r\n      document.removeEventListener('cut', this._handleEvent, true);\r\n      document.removeEventListener('dragstart', this._handleEvent, true);\r\n      document.removeEventListener('keydown', this._handleKeydown, true);\r\n      \r\n      if (this._styleElement) {\r\n        document.head.removeChild(this._styleElement);\r\n        this._styleElement = null;\r\n      }\r\n      \r\n      if (this._observer) {\r\n        this._observer.disconnect();\r\n        this._observer = null;\r\n      }\r\n    },\r\n\r\n    _validatePassword: function(password) {\r\n      if (this.settings.password && this.settings.password !== password) {\r\n        throw new Error('Invalid password');\r\n      }\r\n      return true;\r\n    },\r\n\r\n    enable: function(options) {\r\n      Object.assign(this.settings, options);\r\n      \r\n      if (this.enabled) this.disable();\r\n      \r\n      this._applyStyles();\r\n      this._observeDOM();\r\n      this._attachListeners();\r\n      this.enabled = true;\r\n    },\r\n\r\n    disable: function(password) {\r\n      try {\r\n        this._validatePassword(password);\r\n        this._detachListeners();\r\n        this.enabled = false;\r\n        return true;\r\n      } catch (e) {\r\n        if (this.settings.debug) console.error(e.message);\r\n        return false;\r\n      }\r\n    },\r\n\r\n    toggle: function(state, password) {\r\n      if (typeof state === 'boolean') {\r\n        return state ? this.enable() : this.disable(password);\r\n      }\r\n      return this[this.enabled ? 'disable' : 'enable'](password);\r\n    },\r\n\r\n    updateSettings: function(newSettings) {\r\n      Object.assign(this.settings, newSettings);\r\n      if (this.enabled) {\r\n        this.disable();\r\n        this.enable();\r\n      }\r\n    }\r\n  };\r\n\r\n  return CopyLockr;\r\n}));"],"names":["root","factory","self","this","enabled","version","settings","disableContextMenu","disableCopy","disableCut","disableDrag","disableSelect","disableDevTools","password","customStyles","debug","onBlock","_styleElement","_observer","_handleEvent","e","type","console","log","preventDefault","stopPropagation","_handleKeydown","ctrlOrMeta","ctrlKey","metaKey","keyCode","shiftKey","some","Boolean","_applyStyles","document","createElement","textContent","head","appendChild","_observeDOM","MutationObserver","mutations","forEach","mutation","Array","from","addedNodes","node","nodeType","style","userSelect","observe","body","childList","subtree","_attachListeners","events","contextmenu","copy","cut","dragstart","Object","entries","event","addEventListener","bind","_detachListeners","removeEventListener","removeChild","disconnect","_validatePassword","Error","enable","options","assign","disable","error","message","toggle","state","updateSettings","newSettings","module","exports","CopyLockr"],"mappings":"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"}